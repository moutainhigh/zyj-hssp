<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.hand.hec.gld.mapper.GlAccountEntryMapper">
    <resultMap id="BaseResultMap" type="com.hand.hec.gld.dto.GlAccountEntry">
        <result column="QUERY_BATCH_CODE" property="queryBatchCode" jdbcType="VARCHAR"/>
        <result column="SEGMENT33" property="segment33" jdbcType="VARCHAR"/>
        <result column="SEGMENT34" property="segment34" jdbcType="VARCHAR"/>
        <result column="SEGMENT35" property="segment35" jdbcType="VARCHAR"/>
        <result column="SEGMENT36" property="segment36" jdbcType="VARCHAR"/>
        <result column="SEGMENT37" property="segment37" jdbcType="VARCHAR"/>
        <result column="SEGMENT38" property="segment38" jdbcType="VARCHAR"/>
        <result column="SEGMENT39" property="segment39" jdbcType="VARCHAR"/>
        <result column="SEGMENT40" property="segment40" jdbcType="VARCHAR"/>
        <result column="SEGMENT41" property="segment41" jdbcType="VARCHAR"/>
        <result column="SEGMENT42" property="segment42" jdbcType="VARCHAR"/>
        <result column="SEGMENT43" property="segment43" jdbcType="VARCHAR"/>
        <result column="SEGMENT44" property="segment44" jdbcType="VARCHAR"/>
        <result column="SEGMENT45" property="segment45" jdbcType="VARCHAR"/>
        <result column="SEGMENT46" property="segment46" jdbcType="VARCHAR"/>
        <result column="SEGMENT47" property="segment47" jdbcType="VARCHAR"/>
        <result column="SEGMENT48" property="segment48" jdbcType="VARCHAR"/>
        <result column="SEGMENT49" property="segment49" jdbcType="VARCHAR"/>
        <result column="SEGMENT50" property="segment50" jdbcType="VARCHAR"/>
        <result column="SEGMENT_DESC1" property="segmentDesc1" jdbcType="VARCHAR"/>
        <result column="SEGMENT_DESC2" property="segmentDesc2" jdbcType="VARCHAR"/>
        <result column="SEGMENT_DESC3" property="segmentDesc3" jdbcType="VARCHAR"/>
        <result column="SEGMENT_DESC4" property="segmentDesc4" jdbcType="VARCHAR"/>
        <result column="SEGMENT_DESC5" property="segmentDesc5" jdbcType="VARCHAR"/>
        <result column="SEGMENT_DESC6" property="segmentDesc6" jdbcType="VARCHAR"/>
        <result column="SEGMENT_DESC7" property="segmentDesc7" jdbcType="VARCHAR"/>
        <result column="SEGMENT_DESC8" property="segmentDesc8" jdbcType="VARCHAR"/>
        <result column="SEGMENT_DESC9" property="segmentDesc9" jdbcType="VARCHAR"/>
        <result column="SEGMENT_DESC10" property="segmentDesc10" jdbcType="VARCHAR"/>
        <result column="SEGMENT_DESC11" property="segmentDesc11" jdbcType="VARCHAR"/>
        <result column="SEGMENT_DESC12" property="segmentDesc12" jdbcType="VARCHAR"/>
        <result column="SEGMENT_DESC13" property="segmentDesc13" jdbcType="VARCHAR"/>
        <result column="SEGMENT_DESC14" property="segmentDesc14" jdbcType="VARCHAR"/>
        <result column="SEGMENT_DESC15" property="segmentDesc15" jdbcType="VARCHAR"/>
        <result column="SEGMENT_DESC16" property="segmentDesc16" jdbcType="VARCHAR"/>
        <result column="SEGMENT_DESC17" property="segmentDesc17" jdbcType="VARCHAR"/>
        <result column="SEGMENT_DESC18" property="segmentDesc18" jdbcType="VARCHAR"/>
        <result column="SEGMENT_DESC19" property="segmentDesc19" jdbcType="VARCHAR"/>
        <result column="SEGMENT_DESC20" property="segmentDesc20" jdbcType="VARCHAR"/>
        <result column="SEGMENT_DESC21" property="segmentDesc21" jdbcType="VARCHAR"/>
        <result column="SEGMENT_DESC22" property="segmentDesc22" jdbcType="VARCHAR"/>
        <result column="SEGMENT_DESC23" property="segmentDesc23" jdbcType="VARCHAR"/>
        <result column="SEGMENT_DESC24" property="segmentDesc24" jdbcType="VARCHAR"/>
        <result column="SEGMENT_DESC25" property="segmentDesc25" jdbcType="VARCHAR"/>
        <result column="SEGMENT_DESC26" property="segmentDesc26" jdbcType="VARCHAR"/>
        <result column="SEGMENT_DESC27" property="segmentDesc27" jdbcType="VARCHAR"/>
        <result column="SEGMENT_DESC28" property="segmentDesc28" jdbcType="VARCHAR"/>
        <result column="SEGMENT_DESC29" property="segmentDesc29" jdbcType="VARCHAR"/>
        <result column="SEGMENT_DESC30" property="segmentDesc30" jdbcType="VARCHAR"/>
        <result column="SEGMENT_DESC31" property="segmentDesc31" jdbcType="VARCHAR"/>
        <result column="SEGMENT_DESC32" property="segmentDesc32" jdbcType="VARCHAR"/>
        <result column="SEGMENT_DESC33" property="segmentDesc33" jdbcType="VARCHAR"/>
        <result column="SEGMENT_DESC34" property="segmentDesc34" jdbcType="VARCHAR"/>
        <result column="SEGMENT_DESC35" property="segmentDesc35" jdbcType="VARCHAR"/>
        <result column="SEGMENT_DESC36" property="segmentDesc36" jdbcType="VARCHAR"/>
        <result column="SEGMENT_DESC37" property="segmentDesc37" jdbcType="VARCHAR"/>
        <result column="SEGMENT_DESC38" property="segmentDesc38" jdbcType="VARCHAR"/>
        <result column="SEGMENT_DESC39" property="segmentDesc39" jdbcType="VARCHAR"/>
        <result column="SEGMENT_DESC40" property="segmentDesc40" jdbcType="VARCHAR"/>
        <result column="SEGMENT_DESC41" property="segmentDesc41" jdbcType="VARCHAR"/>
        <result column="SEGMENT_DESC42" property="segmentDesc42" jdbcType="VARCHAR"/>
        <result column="SEGMENT_DESC43" property="segmentDesc43" jdbcType="VARCHAR"/>
        <result column="SEGMENT_DESC44" property="segmentDesc44" jdbcType="VARCHAR"/>
        <result column="SEGMENT_DESC45" property="segmentDesc45" jdbcType="VARCHAR"/>
        <result column="SEGMENT_DESC46" property="segmentDesc46" jdbcType="VARCHAR"/>
        <result column="SEGMENT_DESC47" property="segmentDesc47" jdbcType="VARCHAR"/>
        <result column="SEGMENT_DESC48" property="segmentDesc48" jdbcType="VARCHAR"/>
        <result column="SEGMENT_DESC49" property="segmentDesc49" jdbcType="VARCHAR"/>
        <result column="SEGMENT_DESC50" property="segmentDesc50" jdbcType="VARCHAR"/>
        <result column="BATCH_CODE" property="batchCode" jdbcType="VARCHAR"/>
        <result column="GL_INTERFACE_ID" property="glInterfaceId" jdbcType="DECIMAL"/>
        <result column="IMPORTED_FLAG" property="importedFlag" jdbcType="VARCHAR"/>
        <result column="IMPORT_DATE" property="importDate" jdbcType="DATE"/>
        <result column="JOURNAL_NUMBER" property="journalNumber" jdbcType="VARCHAR"/>
        <result column="ERROR_CODE" property="errorCode" jdbcType="VARCHAR"/>
        <result column="ERROR_MESSAGE" property="errorMessage" jdbcType="VARCHAR"/>
        <result column="ACCOUNT_ENTRY_ID" property="accountEntryId" jdbcType="DECIMAL"/>
        <result column="HEC_SOB_CODE" property="hecSobCode" jdbcType="VARCHAR"/>
        <result column="ACC_ENTITY_ID" property="accEntityId" jdbcType="DECIMAL"/>
        <result column="ACC_ENTITY_CODE" property="accEntityCode" jdbcType="VARCHAR"/>
        <result column="TRANSACTION_TYPE" property="transactionType" jdbcType="VARCHAR"/>
        <result column="TRANSACTION_HEADER_ID" property="transactionHeaderId" jdbcType="DECIMAL"/>
        <result column="TRANSACTION_LINE_ID" property="transactionLineId" jdbcType="DECIMAL"/>
        <result column="TRANSACTION_DIST_ID" property="transactionDistId" jdbcType="DECIMAL"/>
        <result column="TRANSACTION_JE_LINE_ID" property="transactionJeLineId" jdbcType="DECIMAL"/>
        <result column="TRANSACTION_NUMBER" property="transactionNumber" jdbcType="VARCHAR"/>
        <result column="PERIOD_NAME" property="periodName" jdbcType="VARCHAR"/>
        <result column="PERIOD_YEAR" property="periodYear" jdbcType="DECIMAL"/>
        <result column="PERIOD_NUM" property="periodNum" jdbcType="DECIMAL"/>
        <result column="DESCRIPTION" property="description" jdbcType="VARCHAR"/>
        <result column="TRANSACTION_DATE" property="transactionDate" jdbcType="DATE"/>
        <result column="ACCOUNTING_DATE" property="accountingDate" jdbcType="DATE"/>
        <result column="ATTACHMENT_NUM" property="attachmentNum" jdbcType="DECIMAL"/>
        <result column="LINE_DESCRIPTION" property="lineDescription" jdbcType="VARCHAR"/>
        <result column="ACCOUNT_ID" property="accountId" jdbcType="DECIMAL"/>
        <result column="ACCOUNT_CODE" property="accountCode" jdbcType="VARCHAR"/>
        <result column="ENTERED_AMOUNT_DR" property="enteredAmountDr" jdbcType="DECIMAL"/>
        <result column="ENTERED_AMOUNT_CR" property="enteredAmountCr" jdbcType="DECIMAL"/>
        <result column="FUNCTIONAL_AMOUNT_DR" property="functionalAmountDr" jdbcType="DECIMAL"/>
        <result column="FUNCTIONAL_AMOUNT_CR" property="functionalAmountCr" jdbcType="DECIMAL"/>
        <result column="CURRENCY_CODE" property="currencyCode" jdbcType="VARCHAR"/>
        <result column="CURRENCY_CONVERSION_DATE" property="currencyConversionDate" jdbcType="DATE"/>
        <result column="CURRENCY_CONVERSION_RATE" property="currencyConversionRate" jdbcType="DECIMAL"/>
        <result column="CURRENCY_CONVERSION_TYPE" property="currencyConversionType" jdbcType="VARCHAR"/>
        <result column="REVERSE_FLAG" property="reverseFlag" jdbcType="VARCHAR"/>
        <result column="REVERSE_TRANSACTION_ID" property="reverseTransactionId" jdbcType="DECIMAL"/>
        <result column="SEGMENT1" property="segment1" jdbcType="VARCHAR"/>
        <result column="SEGMENT2" property="segment2" jdbcType="VARCHAR"/>
        <result column="SEGMENT3" property="segment3" jdbcType="VARCHAR"/>
        <result column="SEGMENT4" property="segment4" jdbcType="VARCHAR"/>
        <result column="SEGMENT5" property="segment5" jdbcType="VARCHAR"/>
        <result column="SEGMENT6" property="segment6" jdbcType="VARCHAR"/>
        <result column="SEGMENT7" property="segment7" jdbcType="VARCHAR"/>
        <result column="SEGMENT8" property="segment8" jdbcType="VARCHAR"/>
        <result column="SEGMENT9" property="segment9" jdbcType="VARCHAR"/>
        <result column="SEGMENT10" property="segment10" jdbcType="VARCHAR"/>
        <result column="SEGMENT11" property="segment11" jdbcType="VARCHAR"/>
        <result column="SEGMENT12" property="segment12" jdbcType="VARCHAR"/>
        <result column="SEGMENT13" property="segment13" jdbcType="VARCHAR"/>
        <result column="SEGMENT14" property="segment14" jdbcType="VARCHAR"/>
        <result column="SEGMENT15" property="segment15" jdbcType="VARCHAR"/>
        <result column="SEGMENT16" property="segment16" jdbcType="VARCHAR"/>
        <result column="SEGMENT17" property="segment17" jdbcType="VARCHAR"/>
        <result column="SEGMENT18" property="segment18" jdbcType="VARCHAR"/>
        <result column="SEGMENT19" property="segment19" jdbcType="VARCHAR"/>
        <result column="SEGMENT20" property="segment20" jdbcType="VARCHAR"/>
        <result column="SEGMENT21" property="segment21" jdbcType="VARCHAR"/>
        <result column="SEGMENT22" property="segment22" jdbcType="VARCHAR"/>
        <result column="SEGMENT23" property="segment23" jdbcType="VARCHAR"/>
        <result column="SEGMENT24" property="segment24" jdbcType="VARCHAR"/>
        <result column="SEGMENT25" property="segment25" jdbcType="VARCHAR"/>
        <result column="SEGMENT26" property="segment26" jdbcType="VARCHAR"/>
        <result column="SEGMENT27" property="segment27" jdbcType="VARCHAR"/>
        <result column="SEGMENT28" property="segment28" jdbcType="VARCHAR"/>
        <result column="SEGMENT29" property="segment29" jdbcType="VARCHAR"/>
        <result column="SEGMENT30" property="segment30" jdbcType="VARCHAR"/>
        <result column="SEGMENT31" property="segment31" jdbcType="VARCHAR"/>
        <result column="SEGMENT32" property="segment32" jdbcType="VARCHAR"/>
    </resultMap>

    <!-- Modify Tagin/2019.03.29 更新分录导入状态-->
    <update id="updateImportedFlag">
        update gl_account_entry gae
        set gae.imported_flag = #{importedFlag, jdbcType=VARCHAR, javaType=java.lang.String},
        gae.last_updated_by = #{request.userId, jdbcType=DECIMAL, javaType=java.lang.Long},
        gae.last_update_date = CURRENT_DATE
        where gae.transaction_header_id = #{transactionHeaderId, jdbcType=DECIMAL, javaType=java.lang.Long}
        and gae.transaction_type = #{transactionType, jdbcType=VARCHAR, javaType=java.lang.String}
    </update>
    <select id="queryCshTransactionAccount" resultMap="BaseResultMap">
          select sb.set_of_books_code as hec_sob_code,
	             gae.acc_entity_code,
	             ga.account_code,
                 a.acc_entity_id,
                 h.company_id as header_com_id,
                 h.transaction_header_id as transaction_header_id,
                 h.transaction_num as transaction_number,
                 l.transaction_line_id as transaction_line_id,
                 null as transaction_dist_id,
                 a.transaction_je_line_id  as transaction_je_line_id,
                 a.period_name,
                 a.description,
                 h.transaction_date as transaction_date,
                 a.journal_date as accounting_date,
                 null as attachment_num,
                 a.description as line_description,
                 a.account_id,
                 a.entered_amount_dr,
                 a.entered_amount_cr,
                 a.functional_amount_dr,
                 a.functional_amount_cr,
                 a.currency_code,
                 a.journal_date as currency_conversion_date,
                 a.exchange_rate as currency_conversion_rate,
                 a.exchange_rate_type as currency_conversion_type,
                 CASE
                 WHEN h.reversed_flag = 'R' THEN
	                 'Y'
                 ELSE
	                'N'
                 END AS reverse_flag,
                 null as reverse_transaction_id,
                 a.account_segment1 as segment1,
                 a.account_segment2 as segment2,
                 a.account_segment3 as segment3,
                 a.account_segment4 as segment4,
                 a.account_segment5 as segment5,
                 a.account_segment6 as segment6,
                 a.account_segment7 as segment7,
                 a.account_segment8 as segment8,
                 a.account_segment9 as segment9,
                 a.account_segment10 as segment10,
                 a.account_segment11 as segment11,
                 a.account_segment12 as segment12,
                 a.account_segment13 as segment13,
                 a.account_segment14 as segment14,
                 a.account_segment15 as segment15,
                 a.account_segment16 as segment16,
                 a.account_segment17 as segment17,
                 a.account_segment18 as segment18,
                 a.account_segment19 as segment19,
                 a.account_segment20 as segment20,
                 null as segment21,
                 null as segment22,
                 null as segment23,
                 null as segment24,
                 null as segment25,
                 null as segment26,
                 null as segment27,
                 null as segment28,
                 null as segment29,
                 null as segment30,
                 null as segment31,
                 null as segment32,
                 null as segment33,
                 null as segment34,
                 null as segment35,
                 null as segment36,
                 null as segment37,
                 null as segment38,
                 null as segment39,
                 null as segment40,
                 null as segment41,
                 null as segment42,
                 null as segment43,
                 null as segment44,
                 null as segment45,
                 null as segment46,
                 null as segment47,
                 null as segment48,
                 null as segment49,
                 null as segment50,
                 null as segment_desc1,
                 null as segment_desc2,
                 null as segment_desc3,
                 null as segment_desc4,
                 null as segment_desc5,
                 null as segment_desc6,
                 null as segment_desc7,
                 null as segment_desc8,
                 null as segment_desc9,
                 null as segment_desc10,
                 null as segment_desc11,
                 null as segment_desc12,
                 null as segment_desc13,
                 null as segment_desc14,
                 null as segment_desc15,
                 null as segment_desc16,
                 null as segment_desc17,
                 null as segment_desc18,
                 null as segment_desc19,
                 null as segment_desc20,
                 null as segment_desc21,
                 null as segment_desc22,
                 null as segment_desc23,
                 null as segment_desc24,
                 null as segment_desc25,
                 null as segment_desc26,
                 null as segment_desc27,
                 null as segment_desc28,
                 null as segment_desc29,
                 null as segment_desc30,
                 null as segment_desc31,
                 null as segment_desc32,
                 null as segment_desc33,
                 null as segment_desc34,
                 null as segment_desc35,
                 null as segment_desc36,
                 null as segment_desc37,
                 null as segment_desc38,
                 null as segment_desc39,
                 null as segment_desc40,
                 null as segment_desc41,
                 null as segment_desc42,
                 null as segment_desc43,
                 null as segment_desc44,
                 null as segment_desc45,
                 null as segment_desc46,
                 null as segment_desc47,
                 null as segment_desc48,
                 null as segment_desc49,
                 null as segment_desc50,
                 h.returned_flag as attribute1,
                 null as attribute2,
                 null as attribute3,
                 null as attribute4,
                 null as attribute5,
                 null as attribute6,
                 null as attribute7,
                 null as attribute8,
                 null as attribute9,
                 null as attribute10,
                 null as attribute11,
                 null as attribute12,
                 null as attribute13,
                 null as attribute14,
                 null as attribute15,
                 null as attribute16,
                 null as attribute17,
                 null as attribute18,
                 null as attribute19,
                 null as attribute20,
                 null as batch_code,
                 null as gl_interface_id,
                 a.gld_interface_flag as imported_flag,
                 null as import_date,
                 null as journal_number,
                 null as error_code,
                 null as error_message,
                 null as query_batch_code
            from csh_transaction_header h
            INNER JOIN csh_transaction_line l ON l.transaction_header_id = h.transaction_header_id
            INNER JOIN csh_transaction_account a ON a.transaction_line_id = l.transaction_line_id
            INNER JOIN gld_accounting_entity gae on a.acc_entity_id = gae.acc_entity_id
            INNER JOIN gld_acc_entity_ref_sob rs on gae.acc_entity_id = rs.acc_entity_id
            AND rs.default_flag = 'Y'
            INNER JOIN gld_set_of_book sb on rs.set_of_books_id = sb.set_of_books_id
            INNER JOIN gld_account ga on a.account_id = ga.account_id
           where h.transaction_header_id = #{headerId}
    </select>
    <select id="queryExpReportAccount" resultMap="BaseResultMap">
          select sb.set_of_books_code as hec_sob_code,
	             gae.acc_entity_code,
	             ga.account_code,
                 a.acc_entity_id,
                 h.company_id as header_com_id,
                 h.exp_report_header_id as transaction_header_id,
                 h.exp_report_number as transaction_number,
                 l.exp_report_line_id as transaction_line_id,
                 d.exp_report_dist_id as transaction_dist_id,
                 a.exp_report_je_line_id as transaction_je_line_id,
                 a.period_name,
                 h.description,
                 h.report_date as transaction_date,
                 a.journal_date as accounting_date,
                 h.attachment_num,
                 a.description as line_description,
                 a.account_id,
                 a.entered_amount_dr,
                 a.entered_amount_cr,
                 a.functional_amount_dr,
                 a.functional_amount_cr,
                 h.payment_currency_code currency_code,
                 a.journal_date as currency_conversion_date,
                 a.exchange_rate as currency_conversion_rate,
                 a.exchange_rate_type as currency_conversion_type,
                 CASE
                 WHEN h.reversed_flag = 'R' THEN
	                 'Y'
                 ELSE
	                'N'
                 END AS reverse_flag,
                 null as reverse_transaction_id,
                 a.account_segment1 as segment1,
                 a.account_segment2 as segment2,
                 a.account_segment3 as segment3,
                 a.account_segment4 as segment4,
                 a.account_segment5 as segment5,
                 a.account_segment6 as segment6,
                 a.account_segment7 as segment7,
                 a.account_segment8 as segment8,
                 a.account_segment9 as segment9,
                 a.account_segment10 as segment10,
                 a.account_segment11 as segment11,
                 a.account_segment12 as segment12,
                 a.account_segment13 as segment13,
                 a.account_segment14 as segment14,
                 a.account_segment15 as segment15,
                 a.account_segment16 as segment16,
                 a.account_segment17 as segment17,
                 a.account_segment18 as segment18,
                 a.account_segment19 as segment19,
                 a.account_segment20 as segment20,
                 null as segment21,
                 null as segment22,
                 null as segment23,
                 null as segment24,
                 null as segment25,
                 null as segment26,
                 null as segment27,
                 null as segment28,
                 null as segment29,
                 null as segment30,
                 null as segment31,
                 null as segment32,
                 null as segment33,
                 null as segment34,
                 null as segment35,
                 null as segment36,
                 null as segment37,
                 null as segment38,
                 null as segment39,
                 null as segment40,
                 null as segment41,
                 null as segment42,
                 null as segment43,
                 null as segment44,
                 null as segment45,
                 null as segment46,
                 null as segment47,
                 null as segment48,
                 null as segment49,
                 null as segment50,
                 null as segment_desc1,
                 null as segment_desc2,
                 null as segment_desc3,
                 null as segment_desc4,
                 null as segment_desc5,
                 null as segment_desc6,
                 null as segment_desc7,
                 null as segment_desc8,
                 null as segment_desc9,
                 null as segment_desc10,
                 null as segment_desc11,
                 null as segment_desc12,
                 null as segment_desc13,
                 null as segment_desc14,
                 null as segment_desc15,
                 null as segment_desc16,
                 null as segment_desc17,
                 null as segment_desc18,
                 null as segment_desc19,
                 null as segment_desc20,
                 null as segment_desc21,
                 null as segment_desc22,
                 null as segment_desc23,
                 null as segment_desc24,
                 null as segment_desc25,
                 null as segment_desc26,
                 null as segment_desc27,
                 null as segment_desc28,
                 null as segment_desc29,
                 null as segment_desc30,
                 null as segment_desc31,
                 null as segment_desc32,
                 null as segment_desc33,
                 null as segment_desc34,
                 null as segment_desc35,
                 null as segment_desc36,
                 null as segment_desc37,
                 null as segment_desc38,
                 null as segment_desc39,
                 null as segment_desc40,
                 null as segment_desc41,
                 null as segment_desc42,
                 null as segment_desc43,
                 null as segment_desc44,
                 null as segment_desc45,
                 null as segment_desc46,
                 null as segment_desc47,
                 null as segment_desc48,
                 null as segment_desc49,
                 null as segment_desc50,
                 null as attribute1,
                 null as attribute2,
                 null as attribute3,
                 null as attribute4,
                 null as attribute5,
                 null as attribute6,
                 null as attribute7,
                 null as attribute8,
                 null as attribute9,
                 null as attribute10,
                 null as attribute11,
                 null as attribute12,
                 null as attribute13,
                 null as attribute14,
                 null as attribute15,
                 null as attribute16,
                 null as attribute17,
                 null as attribute18,
                 null as attribute19,
                 null as attribute20,
                 null as batch_code,
                 null as gl_interface_id,
                 a.gld_interface_flag as imported_flag,
                 null as import_date,
                 null as journal_number,
                 null as error_code,
                 null as error_message,
                 null as query_batch_code
            from exp_report_header  h
            INNER JOIN  exp_report_line    l ON l.exp_report_header_id = h.exp_report_header_id
            INNER JOIN  exp_report_dist    d ON d.exp_report_line_id = l.exp_report_line_id
            INNER JOIN  exp_report_account a ON a.exp_report_dist_id = d.exp_report_dist_id
            INNER JOIN gld_accounting_entity gae on a.acc_entity_id = gae.acc_entity_id
            INNER JOIN gld_acc_entity_ref_sob rs on gae.acc_entity_id = rs.acc_entity_id
            AND rs.default_flag = 'Y'
            INNER JOIN gld_set_of_book sb on rs.set_of_books_id = sb.set_of_books_id
            INNER JOIN gld_account ga on a.account_id = ga.account_id
           where a.exp_report_dist_id is not null
             and h.exp_report_header_id = #{headerId}
          union all
          select sb.set_of_books_code as hec_sob_code,
	             gae.acc_entity_code,
	             ga.account_code,
                 a.acc_entity_id,
                 h.company_id as header_com_id,
                 h.exp_report_header_id as transaction_header_id,
                 h.exp_report_number as transaction_number,
                 null as transaction_line_id,
                 null as transaction_dist_id,
                 a.exp_report_je_line_id as transaction_je_line_id,
                 a.period_name,
                 h.description,
                 h.report_date as transaction_date,
                 a.journal_date as accounting_date,
                 h.attachment_num,
                 a.description as line_description,
                 a.account_id,
                 a.entered_amount_dr,
                 a.entered_amount_cr,
                 a.functional_amount_dr,
                 a.functional_amount_cr,
                 a.currency_code,
                 a.journal_date as currency_conversion_date,
                 a.exchange_rate as currency_conversion_rate,
                 a.exchange_rate_type as currency_conversion_type,
                 CASE
                 WHEN h.reversed_flag = 'R' THEN
	                 'Y'
                 ELSE
	                'N'
                 END AS reverse_flag,
                 null as reverse_transaction_id,
                 a.account_segment1 as segment1,
                 a.account_segment2 as segment2,
                 a.account_segment3 as segment3,
                 a.account_segment4 as segment4,
                 a.account_segment5 as segment5,
                 a.account_segment6 as segment6,
                 a.account_segment7 as segment7,
                 a.account_segment8 as segment8,
                 a.account_segment9 as segment9,
                 a.account_segment10 as segment10,
                 a.account_segment11 as segment11,
                 a.account_segment12 as segment12,
                 a.account_segment13 as segment13,
                 a.account_segment14 as segment14,
                 a.account_segment15 as segment15,
                 a.account_segment16 as segment16,
                 a.account_segment17 as segment17,
                 a.account_segment18 as segment18,
                 a.account_segment19 as segment19,
                 a.account_segment20 as segment20,
                 null as segment21,
                 null as segment22,
                 null as segment23,
                 null as segment24,
                 null as segment25,
                 null as segment26,
                 null as segment27,
                 null as segment28,
                 null as segment29,
                 null as segment30,
                 null as segment31,
                 null as segment32,
                 null as segment33,
                 null as segment34,
                 null as segment35,
                 null as segment36,
                 null as segment37,
                 null as segment38,
                 null as segment39,
                 null as segment40,
                 null as segment41,
                 null as segment42,
                 null as segment43,
                 null as segment44,
                 null as segment45,
                 null as segment46,
                 null as segment47,
                 null as segment48,
                 null as segment49,
                 null as segment50,
                 null as segment_desc1,
                 null as segment_desc2,
                 null as segment_desc3,
                 null as segment_desc4,
                 null as segment_desc5,
                 null as segment_desc6,
                 null as segment_desc7,
                 null as segment_desc8,
                 null as segment_desc9,
                 null as segment_desc10,
                 null as segment_desc11,
                 null as segment_desc12,
                 null as segment_desc13,
                 null as segment_desc14,
                 null as segment_desc15,
                 null as segment_desc16,
                 null as segment_desc17,
                 null as segment_desc18,
                 null as segment_desc19,
                 null as segment_desc20,
                 null as segment_desc21,
                 null as segment_desc22,
                 null as segment_desc23,
                 null as segment_desc24,
                 null as segment_desc25,
                 null as segment_desc26,
                 null as segment_desc27,
                 null as segment_desc28,
                 null as segment_desc29,
                 null as segment_desc30,
                 null as segment_desc31,
                 null as segment_desc32,
                 null as segment_desc33,
                 null as segment_desc34,
                 null as segment_desc35,
                 null as segment_desc36,
                 null as segment_desc37,
                 null as segment_desc38,
                 null as segment_desc39,
                 null as segment_desc40,
                 null as segment_desc41,
                 null as segment_desc42,
                 null as segment_desc43,
                 null as segment_desc44,
                 null as segment_desc45,
                 null as segment_desc46,
                 null as segment_desc47,
                 null as segment_desc48,
                 null as segment_desc49,
                 null as segment_desc50,
                 null as attribute1,
                 null as attribute2,
                 null as attribute3,
                 null as attribute4,
                 null as attribute5,
                 null as attribute6,
                 null as attribute7,
                 null as attribute8,
                 null as attribute9,
                 null as attribute10,
                 null as attribute11,
                 null as attribute12,
                 null as attribute13,
                 null as attribute14,
                 null as attribute15,
                 null as attribute16,
                 null as attribute17,
                 null as attribute18,
                 null as attribute19,
                 null as attribute20,
                 null as batch_code,
                 null as gl_interface_id,
                 a.gld_interface_flag as imported_flag,
                 null as import_date,
                 null as journal_number,
                 null as error_code,
                 null as error_message,
                 null as query_batch_code
            from exp_report_header  h
            INNER JOIN exp_report_account a ON h.exp_report_header_id = a.exp_report_header_id
            INNER JOIN gld_accounting_entity gae on a.acc_entity_id = gae.acc_entity_id
            INNER JOIN gld_acc_entity_ref_sob rs on gae.acc_entity_id = rs.acc_entity_id
            AND rs.default_flag = 'Y'
            INNER JOIN gld_set_of_book sb on rs.set_of_books_id = sb.set_of_books_id
            INNER JOIN gld_account ga on a.account_id = ga.account_id
           where a.exp_report_dist_id is null
             and h.exp_report_header_id = #{headerId}
    </select>
    <select id="queryCshWriteOffAccount" resultMap="BaseResultMap">
        select sb.set_of_books_code as hec_sob_code,
	           gae.acc_entity_code,
	           ga.account_code,
               a.acc_entity_id,
               a.company_id as header_com_id,
               w.write_off_id as transaction_header_id,
               null as transaction_number,
               null as transaction_line_id,
               null as transaction_dist_id,
               a.write_off_je_line_id as transaction_je_line_id,
               a.period_name,
               a.description,
               w.write_off_date as transaction_date,
               a.journal_date as accounting_date,
               null as attachment_num,
               a.description as line_description,
               a.account_id,
               a.entered_amount_dr,
               a.entered_amount_cr,
               a.functional_amount_dr,
               a.functional_amount_cr,
               a.currency_code,
               a.journal_date as currency_conversion_date,
               a.exchange_rate as currency_conversion_rate,
               a.exchange_rate_type as currency_conversion_type,
               'N' as reverse_flag,
               null as reverse_transaction_id,
               a.account_segment1 as segment1,
               a.account_segment2 as segment2,
               a.account_segment3 as segment3,
               a.account_segment4 as segment4,
               a.account_segment5 as segment5,
               a.account_segment6 as segment6,
               a.account_segment7 as segment7,
               a.account_segment8 as segment8,
               a.account_segment9 as segment9,
               a.account_segment10 as segment10,
               a.account_segment11 as segment11,
               a.account_segment12 as segment12,
               a.account_segment13 as segment13,
               a.account_segment14 as segment14,
               a.account_segment15 as segment15,
               a.account_segment16 as segment16,
               a.account_segment17 as segment17,
               a.account_segment18 as segment18,
               a.account_segment19 as segment19,
               a.account_segment20 as segment20,
               null as segment21,
               null as segment22,
               null as segment23,
               null as segment24,
               null as segment25,
               null as segment26,
               null as segment27,
               null as segment28,
               null as segment29,
               null as segment30,
               null as segment31,
               null as segment32,
               null as segment33,
               null as segment34,
               null as segment35,
               null as segment36,
               null as segment37,
               null as segment38,
               null as segment39,
               null as segment40,
               null as segment41,
               null as segment42,
               null as segment43,
               null as segment44,
               null as segment45,
               null as segment46,
               null as segment47,
               null as segment48,
               null as segment49,
               null as segment50,
               null as segment_desc1,
               null as segment_desc2,
               null as segment_desc3,
               null as segment_desc4,
               null as segment_desc5,
               null as segment_desc6,
               null as segment_desc7,
               null as segment_desc8,
               null as segment_desc9,
               null as segment_desc10,
               null as segment_desc11,
               null as segment_desc12,
               null as segment_desc13,
               null as segment_desc14,
               null as segment_desc15,
               null as segment_desc16,
               null as segment_desc17,
               null as segment_desc18,
               null as segment_desc19,
               null as segment_desc20,
               null as segment_desc21,
               null as segment_desc22,
               null as segment_desc23,
               null as segment_desc24,
               null as segment_desc25,
               null as segment_desc26,
               null as segment_desc27,
               null as segment_desc28,
               null as segment_desc29,
               null as segment_desc30,
               null as segment_desc31,
               null as segment_desc32,
               null as segment_desc33,
               null as segment_desc34,
               null as segment_desc35,
               null as segment_desc36,
               null as segment_desc37,
               null as segment_desc38,
               null as segment_desc39,
               null as segment_desc40,
               null as segment_desc41,
               null as segment_desc42,
               null as segment_desc43,
               null as segment_desc44,
               null as segment_desc45,
               null as segment_desc46,
               null as segment_desc47,
               null as segment_desc48,
               null as segment_desc49,
               null as segment_desc50,
               null as attribute1,
               null as attribute2,
               null as attribute3,
               null as attribute4,
               null as attribute5,
               null as attribute6,
               null as attribute7,
               null as attribute8,
               null as attribute9,
               null as attribute10,
               null as attribute11,
               null as attribute12,
               null as attribute13,
               null as attribute14,
               null as attribute15,
               null as attribute16,
               null as attribute17,
               null as attribute18,
               null as attribute19,
               null as attribute20,
               null as batch_code,
               null as gl_interface_id,
               a.gld_interface_flag as imported_flag,
               null as import_date,
               null as journal_number,
               null as error_code,
               null as error_message,
               null as query_batch_code
          from csh_write_off          w
          INNER JOIN csh_write_off_account  a ON a.write_off_id = w.write_off_id
          INNER JOIN gld_accounting_entity gae on a.acc_entity_id = gae.acc_entity_id
          INNER JOIN gld_acc_entity_ref_sob rs on gae.acc_entity_id = rs.acc_entity_id
          AND rs.default_flag = 'Y'
          INNER JOIN gld_set_of_book sb on rs.set_of_books_id = sb.set_of_books_id
          INNER JOIN gld_account ga on a.account_id = ga.account_id
         where a.write_off_id = #{headerId}
    </select>
    <select id="queryCshPmtReqAccount" resultMap="BaseResultMap">
        select sb.set_of_books_code as hec_sob_code,
	           gae.acc_entity_code,
	           ga.account_code,
               l.acc_entity_id acc_entity_id,
               h.company_id as header_com_id,
               h.payment_requisition_header_id as transaction_header_id,
               h.requisition_number as transaction_number,
               l.payment_requisition_line_id as transaction_line_id,
               null as transaction_dist_id,
               a.payment_req_je_line_id as transaction_je_line_id,
               a.period_name,
               a.description,
               h.requisition_date as transaction_date,
               a.journal_date as accounting_date,
               null as attachment_num,
               l.description as line_description,
               a.account_id,
               a.entered_amount_dr,
               a.entered_amount_cr,
               a.functional_amount_dr,
               a.functional_amount_cr,
               a.currency_code,
               a.journal_date as currency_conversion_date,
               a.exchange_rate as currency_conversion_rate,
               a.exchange_rate_type as currency_conversion_type,
               CASE
               WHEN h.reversed_flag = 'R' THEN
	               'Y'
               ELSE
	               'N'
               END AS reverse_flag,
               null as reverse_transaction_id,
               a.account_segment1 as segment1,
               a.account_segment2 as segment2,
               a.account_segment3 as segment3,
               a.account_segment4 as segment4,
               a.account_segment5 as segment5,
               a.account_segment6 as segment6,
               a.account_segment7 as segment7,
               a.account_segment8 as segment8,
               a.account_segment9 as segment9,
               a.account_segment10 as segment10,
               a.account_segment11 as segment11,
               a.account_segment12 as segment12,
               a.account_segment13 as segment13,
               a.account_segment14 as segment14,
               a.account_segment15 as segment15,
               a.account_segment16 as segment16,
               a.account_segment17 as segment17,
               a.account_segment18 as segment18,
               a.account_segment19 as segment19,
               a.account_segment20 as segment20,
               null as segment21,
               null as segment22,
               null as segment23,
               null as segment24,
               null as segment25,
               null as segment26,
               null as segment27,
               null as segment28,
               null as segment29,
               null as segment30,
               null as segment31,
               null as segment32,
               null as segment33,
               null as segment34,
               null as segment35,
               null as segment36,
               null as segment37,
               null as segment38,
               null as segment39,
               null as segment40,
               null as segment41,
               null as segment42,
               null as segment43,
               null as segment44,
               null as segment45,
               null as segment46,
               null as segment47,
               null as segment48,
               null as segment49,
               null as segment50,
               null as segment_desc1,
               null as segment_desc2,
               null as segment_desc3,
               null as segment_desc4,
               null as segment_desc5,
               null as segment_desc6,
               null as segment_desc7,
               null as segment_desc8,
               null as segment_desc9,
               null as segment_desc10,
               null as segment_desc11,
               null as segment_desc12,
               null as segment_desc13,
               null as segment_desc14,
               null as segment_desc15,
               null as segment_desc16,
               null as segment_desc17,
               null as segment_desc18,
               null as segment_desc19,
               null as segment_desc20,
               null as segment_desc21,
               null as segment_desc22,
               null as segment_desc23,
               null as segment_desc24,
               null as segment_desc25,
               null as segment_desc26,
               null as segment_desc27,
               null as segment_desc28,
               null as segment_desc29,
               null as segment_desc30,
               null as segment_desc31,
               null as segment_desc32,
               null as segment_desc33,
               null as segment_desc34,
               null as segment_desc35,
               null as segment_desc36,
               null as segment_desc37,
               null as segment_desc38,
               null as segment_desc39,
               null as segment_desc40,
               null as segment_desc41,
               null as segment_desc42,
               null as segment_desc43,
               null as segment_desc44,
               null as segment_desc45,
               null as segment_desc46,
               null as segment_desc47,
               null as segment_desc48,
               null as segment_desc49,
               null as segment_desc50,
               null as attribute1,
               null as attribute2,
               null as attribute3,
               null as attribute4,
               null as attribute5,
               null as attribute6,
               null as attribute7,
               null as attribute8,
               null as attribute9,
               null as attribute10,
               null as attribute11,
               null as attribute12,
               null as attribute13,
               null as attribute14,
               null as attribute15,
               null as attribute16,
               null as attribute17,
               null as attribute18,
               null as attribute19,
               null as attribute20,
               null as batch_code,
               null as gl_interface_id,
               a.gld_interface_flag as imported_flag,
               null as import_date,
               null as journal_number,
               null as error_code,
               null as error_message,
               null as query_batch_code
          from csh_payment_requisition_hd h
          INNER JOIN csh_payment_requisition_ln l ON h.payment_requisition_header_id = l.payment_requisition_header_id
          INNER JOIN csh_payment_req_account    a ON l.payment_requisition_line_id = a.payment_requisition_line_id
          INNER JOIN gld_accounting_entity gae on l.acc_entity_id = gae.acc_entity_id
          INNER JOIN gld_acc_entity_ref_sob rs on gae.acc_entity_id = rs.acc_entity_id
          AND rs.default_flag = 'Y'
          INNER JOIN gld_set_of_book sb on rs.set_of_books_id = sb.set_of_books_id
          INNER JOIN gld_account ga on a.account_id = ga.account_id
         where h.payment_requisition_header_id = #{headerId}
    </select>
    <select id="queryAcpReqAccount" resultMap="BaseResultMap">
        select sb.set_of_books_code as hec_sob_code,
	           gae.acc_entity_code,
	           ga.account_code,
               l.acc_entity_id acc_entity_id,
               h.company_id as header_com_id,
               h.requisition_hds_id as transaction_header_id,
               h.requisition_number as transaction_number,
               l.requisition_lns_id as transaction_line_id,
               null as transaction_dist_id,
               a.acp_req_je_line_id as transaction_je_line_id,
               a.period_name,
               a.description,
               h.requisition_date as transaction_date,
               a.journal_date as accounting_date,
               null as attachment_num,
               l.description as line_description,
               a.account_id,
               a.entered_amount_dr,
               a.entered_amount_cr,
               a.functional_amount_dr,
               a.functional_amount_cr,
               a.currency_code,
               a.journal_date as currency_conversion_date,
               a.exchange_rate as currency_conversion_rate,
               a.exchange_rate_type as currency_conversion_type,
               CASE
               WHEN h.reversed_flag = 'R' THEN
	               'Y'
               ELSE
	               'N'
               END AS reverse_flag,
               null as reverse_transaction_id,
               a.account_segment1 as segment1,
               a.account_segment2 as segment2,
               a.account_segment3 as segment3,
               a.account_segment4 as segment4,
               a.account_segment5 as segment5,
               a.account_segment6 as segment6,
               a.account_segment7 as segment7,
               a.account_segment8 as segment8,
               a.account_segment9 as segment9,
               a.account_segment10 as segment10,
               a.account_segment11 as segment11,
               a.account_segment12 as segment12,
               a.account_segment13 as segment13,
               a.account_segment14 as segment14,
               a.account_segment15 as segment15,
               a.account_segment16 as segment16,
               a.account_segment17 as segment17,
               a.account_segment18 as segment18,
               a.account_segment19 as segment19,
               a.account_segment20 as segment20,
               null as segment21,
               null as segment22,
               null as segment23,
               null as segment24,
               null as segment25,
               null as segment26,
               null as segment27,
               null as segment28,
               null as segment29,
               null as segment30,
               null as segment31,
               null as segment32,
               null as segment33,
               null as segment34,
               null as segment35,
               null as segment36,
               null as segment37,
               null as segment38,
               null as segment39,
               null as segment40,
               null as segment41,
               null as segment42,
               null as segment43,
               null as segment44,
               null as segment45,
               null as segment46,
               null as segment47,
               null as segment48,
               null as segment49,
               null as segment50,
               null as segment_desc1,
               null as segment_desc2,
               null as segment_desc3,
               null as segment_desc4,
               null as segment_desc5,
               null as segment_desc6,
               null as segment_desc7,
               null as segment_desc8,
               null as segment_desc9,
               null as segment_desc10,
               null as segment_desc11,
               null as segment_desc12,
               null as segment_desc13,
               null as segment_desc14,
               null as segment_desc15,
               null as segment_desc16,
               null as segment_desc17,
               null as segment_desc18,
               null as segment_desc19,
               null as segment_desc20,
               null as segment_desc21,
               null as segment_desc22,
               null as segment_desc23,
               null as segment_desc24,
               null as segment_desc25,
               null as segment_desc26,
               null as segment_desc27,
               null as segment_desc28,
               null as segment_desc29,
               null as segment_desc30,
               null as segment_desc31,
               null as segment_desc32,
               null as segment_desc33,
               null as segment_desc34,
               null as segment_desc35,
               null as segment_desc36,
               null as segment_desc37,
               null as segment_desc38,
               null as segment_desc39,
               null as segment_desc40,
               null as segment_desc41,
               null as segment_desc42,
               null as segment_desc43,
               null as segment_desc44,
               null as segment_desc45,
               null as segment_desc46,
               null as segment_desc47,
               null as segment_desc48,
               null as segment_desc49,
               null as segment_desc50,
               null as attribute1,
               null as attribute2,
               null as attribute3,
               null as attribute4,
               null as attribute5,
               null as attribute6,
               null as attribute7,
               null as attribute8,
               null as attribute9,
               null as attribute10,
               null as attribute11,
               null as attribute12,
               null as attribute13,
               null as attribute14,
               null as attribute15,
               null as attribute16,
               null as attribute17,
               null as attribute18,
               null as attribute19,
               null as attribute20,
               null as batch_code,
               null as gl_interface_id,
               a.gld_interface_flag as imported_flag,
               null as import_date,
               null as journal_number,
               null as error_code,
               null as error_message,
               null as query_batch_code
          from acp_requisition_hd      h
          INNER JOIN acp_requisition_ln      l ON  h.requisition_hds_id = l.requisition_hds_id
          INNER JOIN acp_requisition_account a ON l.requisition_lns_id = a.requisition_lns_id
          INNER JOIN gld_accounting_entity gae on l.acc_entity_id = gae.acc_entity_id
          INNER JOIN gld_acc_entity_ref_sob rs on gae.acc_entity_id = rs.acc_entity_id
          AND rs.default_flag = 'Y'
          INNER JOIN gld_set_of_book sb on rs.set_of_books_id = sb.set_of_books_id
          INNER JOIN gld_account ga on a.account_id = ga.account_id
         where h.requisition_hds_id = #{headerId}
    </select>
</mapper>